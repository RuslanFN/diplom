{% extends 'layout.html' %}
{% block title %}
    Мой курс
{%endblock%}
{% block content %}


<div id="elem_course" class="content"></div>
<script >
    course =('{{content|safe}}');
    //course = decodeURIComponent(course)
    //alert(course.slice(0));
    course = JSON.parse(course);
    function postreq(item, item2)
    {
        let url = course[item].modules[item2].contents[0].fileurl;
        alert(url);
        $.ajax({
            url: '/pdf',
            type: 'post',
            data: {link: url},}
        );
    }
    for (let item in course){
        document.getElementById("elem_course").innerHTML += '<h1 >' + course[item].name + '</h1>' + '<br>';
        for (let item2 in course[item].modules) {
            if (course[item].modules[item2].modname == "resource" && course[item].modules[item2].contents[0].mimetype == "application/pdf") {
                url = course[item].modules[item2].contents[0].fileurl.replace("https://", "")
                document.getElementById("elem_course").innerHTML +=
               '<form action="/pdf" method="post">' +
                 '<input type="hidden" name="link" value="' +  url + '"> <a href="#" onclick="document.forms[0].submit();return false;">' + course[item].modules[item2].name + '</a> </form>'
            }
        }
    }
</script> +
{%endblock%}
